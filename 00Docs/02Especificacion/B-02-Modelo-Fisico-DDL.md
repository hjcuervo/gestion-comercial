# B-02: Modelo Físico Oracle (DDL)
## Plataforma de Gestión Comercial - Arquitecsoft v0.1

**Fecha:** Febrero 2026  
**Versión:** 1.0  
**Base de Datos:** Oracle Database 23c  
**Esquema:** ARQGCDEV

---

## 1. Convención de Nombres

### 1.1 Tablas

| Elemento | Convención | Ejemplo |
|----------|------------|---------|
| Prefijo | `GC_` (Gestión Comercial) | `GC_EMPRESA` |
| Nombre | UPPER_SNAKE_CASE | `GC_PERSONA_EMPRESA` |
| Máximo | 30 caracteres | — |

### 1.2 Columnas

| Elemento | Convención | Ejemplo |
|----------|------------|---------|
| Nombre | lower_snake_case | `fecha_creacion` |
| Primary Key | `id` | `id` |
| Foreign Key | `{tabla}_id` | `empresa_id` |
| Booleanos | `es_*` o `activo` | `es_contacto_principal` |
| Fechas | `fecha_*` | `fecha_cierre` |
| Timestamps | `fecha_*` (con hora) | `fecha_creacion` |

### 1.3 Constraints

| Tipo | Patrón | Ejemplo |
|------|--------|---------|
| Primary Key | `PK_{tabla}` | `PK_GC_EMPRESA` |
| Foreign Key | `FK_{tabla}_{columna}` | `FK_GC_OPORTUNIDAD_EMPRESA` |
| Unique | `UK_{tabla}_{columnas}` | `UK_GC_USUARIO_EMAIL` |
| Check | `CK_{tabla}_{columna}` | `CK_GC_OPORTUNIDAD_ESTADO` |

### 1.4 Índices

| Tipo | Patrón | Ejemplo |
|------|--------|---------|
| Foreign Key | `IDX_{tabla}_{columna}` | `IDX_GC_OPORTUNIDAD_EMPRESA` |
| Búsqueda | `IDX_{tabla}_{proposito}` | `IDX_GC_EMPRESA_RAZON_SOCIAL` |
| Compuesto | `IDX_{tabla}_{col1}_{col2}` | `IDX_GC_ETAPA_PIPELINE_ORDEN` |

### 1.5 Secuencias

| Patrón | Ejemplo |
|--------|---------|
| `SEQ_{tabla}` | `SEQ_GC_EMPRESA` |

---

## 2. Script DDL Completo

```sql
-- ============================================================================
-- MODELO FÍSICO - GESTIÓN COMERCIAL v0.1
-- Base de datos: Oracle 23c
-- Esquema: ARQGCDEV
-- Fecha: Febrero 2026
-- ============================================================================

-- ============================================================================
-- SECCIÓN 1: TABLAS INDEPENDIENTES (SIN FK A OTRAS TABLAS DEL MODELO)
-- ============================================================================

-- ----------------------------------------------------------------------------
-- 1.1 GC_USUARIO - Usuarios del sistema
-- ----------------------------------------------------------------------------
CREATE TABLE GC_USUARIO (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    username              VARCHAR2(50)   NOT NULL,
    email                 VARCHAR2(100)  NOT NULL,
    password_hash         VARCHAR2(255)  NOT NULL,
    nombres               VARCHAR2(100)  NOT NULL,
    apellidos             VARCHAR2(100)  NOT NULL,
    rol                   VARCHAR2(20)   NOT NULL,
    activo                NUMBER(1)      DEFAULT 1 NOT NULL,
    fecha_creacion        TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    fecha_modificacion    TIMESTAMP,
    
    CONSTRAINT PK_GC_USUARIO PRIMARY KEY (id),
    CONSTRAINT UK_GC_USUARIO_USERNAME UNIQUE (username),
    CONSTRAINT UK_GC_USUARIO_EMAIL UNIQUE (email),
    CONSTRAINT CK_GC_USUARIO_ROL CHECK (rol IN ('ADMIN', 'COMERCIAL', 'LECTURA_KPI')),
    CONSTRAINT CK_GC_USUARIO_ACTIVO CHECK (activo IN (0, 1))
);

COMMENT ON TABLE GC_USUARIO IS 'Usuarios del sistema con autenticación';
COMMENT ON COLUMN GC_USUARIO.rol IS 'ADMIN: Administrador, COMERCIAL: Usuario comercial, LECTURA_KPI: Solo lectura de reportes';

-- ----------------------------------------------------------------------------
-- 1.2 GC_CATALOGO - Catálogos configurables del sistema
-- ----------------------------------------------------------------------------
CREATE TABLE GC_CATALOGO (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    tipo                  VARCHAR2(50)   NOT NULL,
    codigo                VARCHAR2(50)   NOT NULL,
    nombre                VARCHAR2(100)  NOT NULL,
    descripcion           VARCHAR2(200),
    orden                 NUMBER,
    activo                NUMBER(1)      DEFAULT 1 NOT NULL,
    fecha_creacion        TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    
    CONSTRAINT PK_GC_CATALOGO PRIMARY KEY (id),
    CONSTRAINT UK_GC_CATALOGO_TIPO_CODIGO UNIQUE (tipo, codigo),
    CONSTRAINT CK_GC_CATALOGO_TIPO CHECK (tipo IN (
        'TIPO_ACTIVIDAD', 
        'TIPO_DOCUMENTO', 
        'MOTIVO_CIERRE', 
        'MONEDA',
        'TIPO_EMPRESA',
        'ROL_CONTACTO'
    )),
    CONSTRAINT CK_GC_CATALOGO_ACTIVO CHECK (activo IN (0, 1))
);

COMMENT ON TABLE GC_CATALOGO IS 'Catálogos configurables del sistema';
COMMENT ON COLUMN GC_CATALOGO.tipo IS 'Tipo de catálogo: TIPO_ACTIVIDAD, TIPO_DOCUMENTO, MOTIVO_CIERRE, MONEDA';

-- ----------------------------------------------------------------------------
-- 1.3 GC_PERSONA - Personas de contacto
-- ----------------------------------------------------------------------------
CREATE TABLE GC_PERSONA (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    nombres               VARCHAR2(100)  NOT NULL,
    apellidos             VARCHAR2(100)  NOT NULL,
    email                 VARCHAR2(100),
    telefono              VARCHAR2(30),
    activo                NUMBER(1)      DEFAULT 1 NOT NULL,
    fecha_creacion        TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    fecha_modificacion    TIMESTAMP,
    creado_por            NUMBER         NOT NULL,
    modificado_por        NUMBER,
    
    CONSTRAINT PK_GC_PERSONA PRIMARY KEY (id),
    CONSTRAINT FK_GC_PERSONA_CREADO FOREIGN KEY (creado_por) REFERENCES GC_USUARIO(id),
    CONSTRAINT FK_GC_PERSONA_MODIFICADO FOREIGN KEY (modificado_por) REFERENCES GC_USUARIO(id),
    CONSTRAINT CK_GC_PERSONA_ACTIVO CHECK (activo IN (0, 1))
);

COMMENT ON TABLE GC_PERSONA IS 'Personas de contacto que pueden relacionarse con múltiples empresas';

-- ----------------------------------------------------------------------------
-- 1.4 GC_EMPRESA - Empresas (prospectos, clientes, aliados)
-- ----------------------------------------------------------------------------
CREATE TABLE GC_EMPRESA (
    id                       NUMBER GENERATED BY DEFAULT AS IDENTITY,
    tipo                     VARCHAR2(20)   NOT NULL,
    razon_social             VARCHAR2(200)  NOT NULL,
    identificacion_tributaria VARCHAR2(50),
    sitio_web                VARCHAR2(200),
    pais                     VARCHAR2(100),
    estado                   VARCHAR2(20)   DEFAULT 'ACTIVA' NOT NULL,
    fecha_creacion           TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    fecha_modificacion       TIMESTAMP,
    creado_por               NUMBER         NOT NULL,
    modificado_por           NUMBER,
    
    CONSTRAINT PK_GC_EMPRESA PRIMARY KEY (id),
    CONSTRAINT FK_GC_EMPRESA_CREADO FOREIGN KEY (creado_por) REFERENCES GC_USUARIO(id),
    CONSTRAINT FK_GC_EMPRESA_MODIFICADO FOREIGN KEY (modificado_por) REFERENCES GC_USUARIO(id),
    CONSTRAINT CK_GC_EMPRESA_TIPO CHECK (tipo IN ('EMPRESA', 'MULTINACIONAL', 'ALIADO')),
    CONSTRAINT CK_GC_EMPRESA_ESTADO CHECK (estado IN ('ACTIVA', 'INACTIVA'))
);

COMMENT ON TABLE GC_EMPRESA IS 'Empresas registradas: prospectos, clientes o aliados';
COMMENT ON COLUMN GC_EMPRESA.tipo IS 'EMPRESA: Empresa normal, MULTINACIONAL: Corporación global, ALIADO: Partner';

-- ----------------------------------------------------------------------------
-- 1.5 GC_PIPELINE - Pipelines configurables
-- ----------------------------------------------------------------------------
CREATE TABLE GC_PIPELINE (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    nombre                VARCHAR2(100)  NOT NULL,
    ambito                VARCHAR2(50)   DEFAULT 'GESTION_COMERCIAL' NOT NULL,
    version               NUMBER         DEFAULT 1 NOT NULL,
    estado                VARCHAR2(20)   DEFAULT 'ACTIVO' NOT NULL,
    es_default            NUMBER(1)      DEFAULT 0 NOT NULL,
    fecha_creacion        TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    fecha_modificacion    TIMESTAMP,
    creado_por            NUMBER         NOT NULL,
    modificado_por        NUMBER,
    
    CONSTRAINT PK_GC_PIPELINE PRIMARY KEY (id),
    CONSTRAINT FK_GC_PIPELINE_CREADO FOREIGN KEY (creado_por) REFERENCES GC_USUARIO(id),
    CONSTRAINT FK_GC_PIPELINE_MODIFICADO FOREIGN KEY (modificado_por) REFERENCES GC_USUARIO(id),
    CONSTRAINT CK_GC_PIPELINE_ESTADO CHECK (estado IN ('ACTIVO', 'INACTIVO')),
    CONSTRAINT CK_GC_PIPELINE_DEFAULT CHECK (es_default IN (0, 1))
);

COMMENT ON TABLE GC_PIPELINE IS 'Pipelines de proceso comercial configurables';
COMMENT ON COLUMN GC_PIPELINE.ambito IS 'Ámbito del pipeline: GESTION_COMERCIAL (extensible a futuro)';

-- ============================================================================
-- SECCIÓN 2: TABLAS CON DEPENDENCIAS SIMPLES
-- ============================================================================

-- ----------------------------------------------------------------------------
-- 2.1 GC_PERSONA_EMPRESA - Relación N:M Persona-Empresa
-- ----------------------------------------------------------------------------
CREATE TABLE GC_PERSONA_EMPRESA (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    persona_id            NUMBER         NOT NULL,
    empresa_id            NUMBER         NOT NULL,
    cargo                 VARCHAR2(100),
    puesto                VARCHAR2(100),
    rol_contacto          VARCHAR2(50),
    email_empresarial     VARCHAR2(100),
    telefono_empresarial  VARCHAR2(30),
    es_contacto_principal NUMBER(1)      DEFAULT 0 NOT NULL,
    activo                NUMBER(1)      DEFAULT 1 NOT NULL,
    fecha_creacion        TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    fecha_modificacion    TIMESTAMP,
    
    CONSTRAINT PK_GC_PERSONA_EMPRESA PRIMARY KEY (id),
    CONSTRAINT FK_GC_PERSONA_EMPRESA_PERSONA FOREIGN KEY (persona_id) REFERENCES GC_PERSONA(id),
    CONSTRAINT FK_GC_PERSONA_EMPRESA_EMPRESA FOREIGN KEY (empresa_id) REFERENCES GC_EMPRESA(id),
    CONSTRAINT UK_GC_PERSONA_EMPRESA UNIQUE (persona_id, empresa_id),
    CONSTRAINT CK_GC_PERSONA_EMP_ROL CHECK (rol_contacto IS NULL OR rol_contacto IN (
        'DECISOR', 'INFLUENCIADOR', 'TECNICO', 'USUARIO', 'ADMINISTRATIVO'
    )),
    CONSTRAINT CK_GC_PERSONA_EMP_PRINCIPAL CHECK (es_contacto_principal IN (0, 1)),
    CONSTRAINT CK_GC_PERSONA_EMP_ACTIVO CHECK (activo IN (0, 1))
);

COMMENT ON TABLE GC_PERSONA_EMPRESA IS 'Relación persona-empresa con datos de contexto laboral';
COMMENT ON COLUMN GC_PERSONA_EMPRESA.rol_contacto IS 'Rol en el proceso de compra: DECISOR, INFLUENCIADOR, TECNICO, USUARIO';

-- ----------------------------------------------------------------------------
-- 2.2 GC_ETAPA - Etapas de pipeline
-- ----------------------------------------------------------------------------
CREATE TABLE GC_ETAPA (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    pipeline_id           NUMBER         NOT NULL,
    nombre                VARCHAR2(100)  NOT NULL,
    orden                 NUMBER         NOT NULL,
    probabilidad_sugerida NUMBER(3),
    color                 VARCHAR2(7),
    modo_bloqueo          NUMBER(1)      DEFAULT 0 NOT NULL,
    estado                VARCHAR2(20)   DEFAULT 'ACTIVA' NOT NULL,
    fecha_creacion        TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    fecha_modificacion    TIMESTAMP,
    
    CONSTRAINT PK_GC_ETAPA PRIMARY KEY (id),
    CONSTRAINT FK_GC_ETAPA_PIPELINE FOREIGN KEY (pipeline_id) REFERENCES GC_PIPELINE(id),
    CONSTRAINT UK_GC_ETAPA_PIPELINE_ORDEN UNIQUE (pipeline_id, orden),
    CONSTRAINT CK_GC_ETAPA_PROBABILIDAD CHECK (probabilidad_sugerida IS NULL OR (probabilidad_sugerida >= 0 AND probabilidad_sugerida <= 100)),
    CONSTRAINT CK_GC_ETAPA_BLOQUEO CHECK (modo_bloqueo IN (0, 1)),
    CONSTRAINT CK_GC_ETAPA_ESTADO CHECK (estado IN ('ACTIVA', 'INACTIVA'))
);

COMMENT ON TABLE GC_ETAPA IS 'Etapas dentro de un pipeline comercial';
COMMENT ON COLUMN GC_ETAPA.modo_bloqueo IS '0: Modo guía (default), 1: Requiere completar requisitos';
COMMENT ON COLUMN GC_ETAPA.color IS 'Color hexadecimal para UI (#RRGGBB)';

-- ============================================================================
-- SECCIÓN 3: TABLA PRINCIPAL - OPORTUNIDAD
-- ============================================================================

-- ----------------------------------------------------------------------------
-- 3.1 GC_OPORTUNIDAD - Oportunidades comerciales
-- ----------------------------------------------------------------------------
CREATE TABLE GC_OPORTUNIDAD (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    nombre                VARCHAR2(200)  NOT NULL,
    empresa_id            NUMBER         NOT NULL,
    pipeline_id           NUMBER         NOT NULL,
    etapa_id              NUMBER         NOT NULL,
    estado_macro          VARCHAR2(20)   DEFAULT 'ABIERTA' NOT NULL,
    valor_estimado        NUMBER(15,2),
    moneda                VARCHAR2(3)    DEFAULT 'COP',
    probabilidad          NUMBER(3),
    fecha_estimada_cierre DATE,
    fuente                VARCHAR2(100),
    tipo_servicio         VARCHAR2(100),
    motivo_cierre_id      NUMBER,
    comentario_cierre     VARCHAR2(500),
    fecha_cierre          TIMESTAMP,
    fecha_creacion        TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    fecha_modificacion    TIMESTAMP,
    creado_por            NUMBER         NOT NULL,
    modificado_por        NUMBER,
    
    CONSTRAINT PK_GC_OPORTUNIDAD PRIMARY KEY (id),
    CONSTRAINT FK_GC_OPORTUNIDAD_EMPRESA FOREIGN KEY (empresa_id) REFERENCES GC_EMPRESA(id),
    CONSTRAINT FK_GC_OPORTUNIDAD_PIPELINE FOREIGN KEY (pipeline_id) REFERENCES GC_PIPELINE(id),
    CONSTRAINT FK_GC_OPORTUNIDAD_ETAPA FOREIGN KEY (etapa_id) REFERENCES GC_ETAPA(id),
    CONSTRAINT FK_GC_OPORTUNIDAD_MOTIVO FOREIGN KEY (motivo_cierre_id) REFERENCES GC_CATALOGO(id),
    CONSTRAINT FK_GC_OPORTUNIDAD_CREADO FOREIGN KEY (creado_por) REFERENCES GC_USUARIO(id),
    CONSTRAINT FK_GC_OPORTUNIDAD_MODIFICADO FOREIGN KEY (modificado_por) REFERENCES GC_USUARIO(id),
    CONSTRAINT CK_GC_OPORTUNIDAD_ESTADO CHECK (estado_macro IN (
        'ABIERTA', 'SEGUIMIENTO', 'GANADA', 'PERDIDA', 'NO_CONCRETADA'
    )),
    CONSTRAINT CK_GC_OPORTUNIDAD_PROBABILIDAD CHECK (probabilidad IS NULL OR (probabilidad >= 0 AND probabilidad <= 100)),
    CONSTRAINT CK_GC_OPORTUNIDAD_MONEDA CHECK (moneda IS NULL OR moneda IN ('COP', 'USD', 'EUR'))
);

COMMENT ON TABLE GC_OPORTUNIDAD IS 'Oportunidades comerciales - entidad central del proceso';
COMMENT ON COLUMN GC_OPORTUNIDAD.estado_macro IS 'Estado general: ABIERTA, SEGUIMIENTO, GANADA, PERDIDA, NO_CONCRETADA';

-- ============================================================================
-- SECCIÓN 4: TABLAS DEPENDIENTES DE OPORTUNIDAD
-- ============================================================================

-- ----------------------------------------------------------------------------
-- 4.1 GC_OPORTUNIDAD_RESPONSABLE - Responsables de oportunidad (N:M)
-- ----------------------------------------------------------------------------
CREATE TABLE GC_OPORTUNIDAD_RESPONSABLE (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    oportunidad_id        NUMBER         NOT NULL,
    tipo_responsable      VARCHAR2(20)   NOT NULL,
    usuario_id            NUMBER,
    persona_id            NUMBER,
    rol                   VARCHAR2(50)   DEFAULT 'PRINCIPAL' NOT NULL,
    activo                NUMBER(1)      DEFAULT 1 NOT NULL,
    fecha_asignacion      TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    
    CONSTRAINT PK_GC_OPORTUNIDAD_RESP PRIMARY KEY (id),
    CONSTRAINT FK_GC_OPOR_RESP_OPORTUNIDAD FOREIGN KEY (oportunidad_id) REFERENCES GC_OPORTUNIDAD(id),
    CONSTRAINT FK_GC_OPOR_RESP_USUARIO FOREIGN KEY (usuario_id) REFERENCES GC_USUARIO(id),
    CONSTRAINT FK_GC_OPOR_RESP_PERSONA FOREIGN KEY (persona_id) REFERENCES GC_PERSONA(id),
    CONSTRAINT CK_GC_OPOR_RESP_TIPO CHECK (tipo_responsable IN ('USUARIO', 'PERSONA_EXTERNA')),
    CONSTRAINT CK_GC_OPOR_RESP_ROL CHECK (rol IN ('PRINCIPAL', 'APOYO', 'TECNICO')),
    CONSTRAINT CK_GC_OPOR_RESP_ACTIVO CHECK (activo IN (0, 1)),
    CONSTRAINT CK_GC_OPOR_RESP_XOR CHECK (
        (tipo_responsable = 'USUARIO' AND usuario_id IS NOT NULL AND persona_id IS NULL) OR
        (tipo_responsable = 'PERSONA_EXTERNA' AND persona_id IS NOT NULL AND usuario_id IS NULL)
    )
);

COMMENT ON TABLE GC_OPORTUNIDAD_RESPONSABLE IS 'Responsables asignados a oportunidades (internos o externos)';
COMMENT ON COLUMN GC_OPORTUNIDAD_RESPONSABLE.tipo_responsable IS 'USUARIO: Usuario interno, PERSONA_EXTERNA: Contacto externo';

-- ----------------------------------------------------------------------------
-- 4.2 GC_OPORTUNIDAD_CONTACTO - Contactos de oportunidad (N:M)
-- ----------------------------------------------------------------------------
CREATE TABLE GC_OPORTUNIDAD_CONTACTO (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    oportunidad_id        NUMBER         NOT NULL,
    persona_empresa_id    NUMBER         NOT NULL,
    es_contacto_principal NUMBER(1)      DEFAULT 0 NOT NULL,
    fecha_asignacion      TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    
    CONSTRAINT PK_GC_OPORTUNIDAD_CONTACTO PRIMARY KEY (id),
    CONSTRAINT FK_GC_OPOR_CONT_OPORTUNIDAD FOREIGN KEY (oportunidad_id) REFERENCES GC_OPORTUNIDAD(id),
    CONSTRAINT FK_GC_OPOR_CONT_PERSONA_EMP FOREIGN KEY (persona_empresa_id) REFERENCES GC_PERSONA_EMPRESA(id),
    CONSTRAINT UK_GC_OPOR_CONTACTO UNIQUE (oportunidad_id, persona_empresa_id),
    CONSTRAINT CK_GC_OPOR_CONT_PRINCIPAL CHECK (es_contacto_principal IN (0, 1))
);

COMMENT ON TABLE GC_OPORTUNIDAD_CONTACTO IS 'Personas de contacto asignadas a oportunidades';

-- ----------------------------------------------------------------------------
-- 4.3 GC_HISTORIAL_ETAPA - Auditoría de movimientos de etapa
-- ----------------------------------------------------------------------------
CREATE TABLE GC_HISTORIAL_ETAPA (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    oportunidad_id        NUMBER         NOT NULL,
    etapa_origen_id       NUMBER,
    etapa_destino_id      NUMBER         NOT NULL,
    estado_macro_origen   VARCHAR2(20),
    estado_macro_destino  VARCHAR2(20)   NOT NULL,
    comentario            VARCHAR2(500),
    fecha_movimiento      TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    realizado_por         NUMBER         NOT NULL,
    
    CONSTRAINT PK_GC_HISTORIAL_ETAPA PRIMARY KEY (id),
    CONSTRAINT FK_GC_HIST_ETAPA_OPORTUNIDAD FOREIGN KEY (oportunidad_id) REFERENCES GC_OPORTUNIDAD(id),
    CONSTRAINT FK_GC_HIST_ETAPA_ORIGEN FOREIGN KEY (etapa_origen_id) REFERENCES GC_ETAPA(id),
    CONSTRAINT FK_GC_HIST_ETAPA_DESTINO FOREIGN KEY (etapa_destino_id) REFERENCES GC_ETAPA(id),
    CONSTRAINT FK_GC_HIST_ETAPA_USUARIO FOREIGN KEY (realizado_por) REFERENCES GC_USUARIO(id)
);

COMMENT ON TABLE GC_HISTORIAL_ETAPA IS 'Registro histórico de movimientos entre etapas';
COMMENT ON COLUMN GC_HISTORIAL_ETAPA.etapa_origen_id IS 'NULL si es la creación inicial de la oportunidad';

-- ----------------------------------------------------------------------------
-- 4.4 GC_ACTIVIDAD - Actividades registradas
-- ----------------------------------------------------------------------------
CREATE TABLE GC_ACTIVIDAD (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    oportunidad_id        NUMBER         NOT NULL,
    tipo_actividad_id     NUMBER         NOT NULL,
    fecha_hora            TIMESTAMP      NOT NULL,
    duracion_minutos      NUMBER,
    notas                 VARCHAR2(2000),
    fecha_creacion        TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    creado_por            NUMBER         NOT NULL,
    
    CONSTRAINT PK_GC_ACTIVIDAD PRIMARY KEY (id),
    CONSTRAINT FK_GC_ACTIVIDAD_OPORTUNIDAD FOREIGN KEY (oportunidad_id) REFERENCES GC_OPORTUNIDAD(id),
    CONSTRAINT FK_GC_ACTIVIDAD_TIPO FOREIGN KEY (tipo_actividad_id) REFERENCES GC_CATALOGO(id),
    CONSTRAINT FK_GC_ACTIVIDAD_CREADO FOREIGN KEY (creado_por) REFERENCES GC_USUARIO(id)
);

COMMENT ON TABLE GC_ACTIVIDAD IS 'Actividades comerciales registradas (reuniones, llamadas, etc.)';

-- ----------------------------------------------------------------------------
-- 4.5 GC_ACTIVIDAD_PARTICIPANTE - Participantes de actividad (N:M)
-- ----------------------------------------------------------------------------
CREATE TABLE GC_ACTIVIDAD_PARTICIPANTE (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    actividad_id          NUMBER         NOT NULL,
    tipo_participante     VARCHAR2(20)   NOT NULL,
    usuario_id            NUMBER,
    persona_id            NUMBER,
    
    CONSTRAINT PK_GC_ACTIVIDAD_PARTIC PRIMARY KEY (id),
    CONSTRAINT FK_GC_ACT_PART_ACTIVIDAD FOREIGN KEY (actividad_id) REFERENCES GC_ACTIVIDAD(id),
    CONSTRAINT FK_GC_ACT_PART_USUARIO FOREIGN KEY (usuario_id) REFERENCES GC_USUARIO(id),
    CONSTRAINT FK_GC_ACT_PART_PERSONA FOREIGN KEY (persona_id) REFERENCES GC_PERSONA(id),
    CONSTRAINT CK_GC_ACT_PART_TIPO CHECK (tipo_participante IN ('USUARIO', 'PERSONA_EXTERNA')),
    CONSTRAINT CK_GC_ACT_PART_XOR CHECK (
        (tipo_participante = 'USUARIO' AND usuario_id IS NOT NULL AND persona_id IS NULL) OR
        (tipo_participante = 'PERSONA_EXTERNA' AND persona_id IS NOT NULL AND usuario_id IS NULL)
    )
);

COMMENT ON TABLE GC_ACTIVIDAD_PARTICIPANTE IS 'Participantes en actividades comerciales';

-- ----------------------------------------------------------------------------
-- 4.6 GC_COMPROMISO - Compromisos derivados de actividades
-- ----------------------------------------------------------------------------
CREATE TABLE GC_COMPROMISO (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    actividad_id          NUMBER         NOT NULL,
    descripcion           VARCHAR2(500)  NOT NULL,
    fecha_compromiso      DATE           NOT NULL,
    estado                VARCHAR2(20)   DEFAULT 'PENDIENTE' NOT NULL,
    fecha_completado      TIMESTAMP,
    notas_cierre          VARCHAR2(500),
    fecha_creacion        TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    fecha_modificacion    TIMESTAMP,
    creado_por            NUMBER         NOT NULL,
    
    CONSTRAINT PK_GC_COMPROMISO PRIMARY KEY (id),
    CONSTRAINT FK_GC_COMPROMISO_ACTIVIDAD FOREIGN KEY (actividad_id) REFERENCES GC_ACTIVIDAD(id),
    CONSTRAINT FK_GC_COMPROMISO_CREADO FOREIGN KEY (creado_por) REFERENCES GC_USUARIO(id),
    CONSTRAINT CK_GC_COMPROMISO_ESTADO CHECK (estado IN (
        'PENDIENTE', 'EN_PROGRESO', 'COMPLETADO', 'CANCELADO'
    ))
);

COMMENT ON TABLE GC_COMPROMISO IS 'Compromisos derivados de actividades comerciales';

-- ----------------------------------------------------------------------------
-- 4.7 GC_COMPROMISO_RESPONSABLE - Responsables de compromiso (N:M)
-- ----------------------------------------------------------------------------
CREATE TABLE GC_COMPROMISO_RESPONSABLE (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    compromiso_id         NUMBER         NOT NULL,
    tipo_responsable      VARCHAR2(20)   NOT NULL,
    usuario_id            NUMBER,
    persona_id            NUMBER,
    
    CONSTRAINT PK_GC_COMPROMISO_RESP PRIMARY KEY (id),
    CONSTRAINT FK_GC_COMP_RESP_COMPROMISO FOREIGN KEY (compromiso_id) REFERENCES GC_COMPROMISO(id),
    CONSTRAINT FK_GC_COMP_RESP_USUARIO FOREIGN KEY (usuario_id) REFERENCES GC_USUARIO(id),
    CONSTRAINT FK_GC_COMP_RESP_PERSONA FOREIGN KEY (persona_id) REFERENCES GC_PERSONA(id),
    CONSTRAINT CK_GC_COMP_RESP_TIPO CHECK (tipo_responsable IN ('USUARIO', 'PERSONA_EXTERNA')),
    CONSTRAINT CK_GC_COMP_RESP_XOR CHECK (
        (tipo_responsable = 'USUARIO' AND usuario_id IS NOT NULL AND persona_id IS NULL) OR
        (tipo_responsable = 'PERSONA_EXTERNA' AND persona_id IS NOT NULL AND usuario_id IS NULL)
    )
);

COMMENT ON TABLE GC_COMPROMISO_RESPONSABLE IS 'Responsables asignados a compromisos';

-- ----------------------------------------------------------------------------
-- 4.8 GC_DOCUMENTO - Metadatos de documentos
-- ----------------------------------------------------------------------------
CREATE TABLE GC_DOCUMENTO (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    oportunidad_id        NUMBER,
    actividad_id          NUMBER,
    tipo_documento_id     NUMBER         NOT NULL,
    nombre                VARCHAR2(200)  NOT NULL,
    nombre_original       VARCHAR2(200)  NOT NULL,
    extension             VARCHAR2(10)   NOT NULL,
    tamano_bytes          NUMBER         NOT NULL,
    url_storage           VARCHAR2(500)  NOT NULL,
    bucket_name           VARCHAR2(100)  NOT NULL,
    object_key            VARCHAR2(200)  NOT NULL,
    fecha_carga           TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    cargado_por           NUMBER         NOT NULL,
    
    CONSTRAINT PK_GC_DOCUMENTO PRIMARY KEY (id),
    CONSTRAINT FK_GC_DOCUMENTO_OPORTUNIDAD FOREIGN KEY (oportunidad_id) REFERENCES GC_OPORTUNIDAD(id),
    CONSTRAINT FK_GC_DOCUMENTO_ACTIVIDAD FOREIGN KEY (actividad_id) REFERENCES GC_ACTIVIDAD(id),
    CONSTRAINT FK_GC_DOCUMENTO_TIPO FOREIGN KEY (tipo_documento_id) REFERENCES GC_CATALOGO(id),
    CONSTRAINT FK_GC_DOCUMENTO_CARGADO FOREIGN KEY (cargado_por) REFERENCES GC_USUARIO(id),
    CONSTRAINT CK_GC_DOCUMENTO_ASOCIACION CHECK (
        oportunidad_id IS NOT NULL OR actividad_id IS NOT NULL
    )
);

COMMENT ON TABLE GC_DOCUMENTO IS 'Metadatos de documentos almacenados en OCI Object Storage';
COMMENT ON COLUMN GC_DOCUMENTO.url_storage IS 'URL completa del documento en OCI Object Storage';

-- ============================================================================
-- SECCIÓN 5: TABLA DE AUDITORÍA GENERAL
-- ============================================================================

-- ----------------------------------------------------------------------------
-- 5.1 GC_AUDITORIA_EVENTO - Log general de eventos
-- ----------------------------------------------------------------------------
CREATE TABLE GC_AUDITORIA_EVENTO (
    id                    NUMBER GENERATED BY DEFAULT AS IDENTITY,
    entidad               VARCHAR2(50)   NOT NULL,
    entidad_id            NUMBER         NOT NULL,
    accion                VARCHAR2(20)   NOT NULL,
    datos_anteriores      CLOB,
    datos_nuevos          CLOB,
    usuario_id            NUMBER         NOT NULL,
    ip_address            VARCHAR2(50),
    fecha_evento          TIMESTAMP      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    
    CONSTRAINT PK_GC_AUDITORIA_EVENTO PRIMARY KEY (id),
    CONSTRAINT FK_GC_AUDITORIA_USUARIO FOREIGN KEY (usuario_id) REFERENCES GC_USUARIO(id),
    CONSTRAINT CK_GC_AUDITORIA_ACCION CHECK (accion IN ('CREATE', 'UPDATE', 'DELETE'))
);

COMMENT ON TABLE GC_AUDITORIA_EVENTO IS 'Log general de auditoría para todas las entidades';
COMMENT ON COLUMN GC_AUDITORIA_EVENTO.datos_anteriores IS 'JSON con valores anteriores al cambio';
COMMENT ON COLUMN GC_AUDITORIA_EVENTO.datos_nuevos IS 'JSON con valores nuevos después del cambio';

-- ============================================================================
-- SECCIÓN 6: ÍNDICES
-- ============================================================================

-- 6.1 Índices para Foreign Keys (mejoran JOINs y deletes)
CREATE INDEX IDX_GC_PERSONA_CREADO ON GC_PERSONA(creado_por);
CREATE INDEX IDX_GC_EMPRESA_CREADO ON GC_EMPRESA(creado_por);
CREATE INDEX IDX_GC_PERSONA_EMP_PERSONA ON GC_PERSONA_EMPRESA(persona_id);
CREATE INDEX IDX_GC_PERSONA_EMP_EMPRESA ON GC_PERSONA_EMPRESA(empresa_id);
CREATE INDEX IDX_GC_ETAPA_PIPELINE ON GC_ETAPA(pipeline_id);
CREATE INDEX IDX_GC_OPORTUNIDAD_EMPRESA ON GC_OPORTUNIDAD(empresa_id);
CREATE INDEX IDX_GC_OPORTUNIDAD_PIPELINE ON GC_OPORTUNIDAD(pipeline_id);
CREATE INDEX IDX_GC_OPORTUNIDAD_ETAPA ON GC_OPORTUNIDAD(etapa_id);
CREATE INDEX IDX_GC_OPORTUNIDAD_CREADO ON GC_OPORTUNIDAD(creado_por);
CREATE INDEX IDX_GC_OPOR_RESP_OPORTUNIDAD ON GC_OPORTUNIDAD_RESPONSABLE(oportunidad_id);
CREATE INDEX IDX_GC_OPOR_RESP_USUARIO ON GC_OPORTUNIDAD_RESPONSABLE(usuario_id);
CREATE INDEX IDX_GC_OPOR_CONT_OPORTUNIDAD ON GC_OPORTUNIDAD_CONTACTO(oportunidad_id);
CREATE INDEX IDX_GC_HIST_ETAPA_OPORTUNIDAD ON GC_HISTORIAL_ETAPA(oportunidad_id);
CREATE INDEX IDX_GC_ACTIVIDAD_OPORTUNIDAD ON GC_ACTIVIDAD(oportunidad_id);
CREATE INDEX IDX_GC_ACT_PART_ACTIVIDAD ON GC_ACTIVIDAD_PARTICIPANTE(actividad_id);
CREATE INDEX IDX_GC_COMPROMISO_ACTIVIDAD ON GC_COMPROMISO(actividad_id);
CREATE INDEX IDX_GC_COMP_RESP_COMPROMISO ON GC_COMPROMISO_RESPONSABLE(compromiso_id);
CREATE INDEX IDX_GC_DOCUMENTO_OPORTUNIDAD ON GC_DOCUMENTO(oportunidad_id);
CREATE INDEX IDX_GC_DOCUMENTO_ACTIVIDAD ON GC_DOCUMENTO(actividad_id);
CREATE INDEX IDX_GC_AUDITORIA_USUARIO ON GC_AUDITORIA_EVENTO(usuario_id);

-- 6.2 Índices para búsquedas frecuentes
CREATE INDEX IDX_GC_EMPRESA_RAZON_SOCIAL ON GC_EMPRESA(UPPER(razon_social));
CREATE INDEX IDX_GC_EMPRESA_ESTADO ON GC_EMPRESA(estado);
CREATE INDEX IDX_GC_PERSONA_NOMBRES ON GC_PERSONA(UPPER(nombres), UPPER(apellidos));
CREATE INDEX IDX_GC_OPORTUNIDAD_NOMBRE ON GC_OPORTUNIDAD(UPPER(nombre));
CREATE INDEX IDX_GC_OPORTUNIDAD_ESTADO ON GC_OPORTUNIDAD(estado_macro);
CREATE INDEX IDX_GC_OPORTUNIDAD_FECHA_CIERRE ON GC_OPORTUNIDAD(fecha_estimada_cierre);
CREATE INDEX IDX_GC_CATALOGO_TIPO ON GC_CATALOGO(tipo);
CREATE INDEX IDX_GC_COMPROMISO_ESTADO ON GC_COMPROMISO(estado);
CREATE INDEX IDX_GC_COMPROMISO_FECHA ON GC_COMPROMISO(fecha_compromiso);

-- 6.3 Índices para auditoría y reportes
CREATE INDEX IDX_GC_HIST_ETAPA_FECHA ON GC_HISTORIAL_ETAPA(fecha_movimiento);
CREATE INDEX IDX_GC_ACTIVIDAD_FECHA ON GC_ACTIVIDAD(fecha_hora);
CREATE INDEX IDX_GC_AUDITORIA_ENTIDAD ON GC_AUDITORIA_EVENTO(entidad, entidad_id);
CREATE INDEX IDX_GC_AUDITORIA_FECHA ON GC_AUDITORIA_EVENTO(fecha_evento);

-- ============================================================================
-- SECCIÓN 7: DATOS INICIALES (CATÁLOGOS)
-- ============================================================================

-- 7.1 Tipos de Actividad
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_ACTIVIDAD', 'REUNION', 'Reunión', 1, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_ACTIVIDAD', 'LLAMADA', 'Llamada', 2, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_ACTIVIDAD', 'VISITA', 'Visita', 3, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_ACTIVIDAD', 'DEMO', 'Demo', 4, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_ACTIVIDAD', 'PRESENTACION', 'Presentación', 5, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_ACTIVIDAD', 'ENVIO_PROPUESTA', 'Envío de propuesta', 6, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_ACTIVIDAD', 'SEGUIMIENTO', 'Seguimiento', 7, 1);

-- 7.2 Tipos de Documento
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_DOCUMENTO', 'PROPUESTA', 'Propuesta', 1, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_DOCUMENTO', 'ESTIMACION', 'Estimación económica', 2, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_DOCUMENTO', 'RFP', 'RFP', 3, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_DOCUMENTO', 'ACTA', 'Acta', 4, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_DOCUMENTO', 'COTIZACION', 'Cotización', 5, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_DOCUMENTO', 'CONTRATO_BORRADOR', 'Contrato borrador', 6, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_DOCUMENTO', 'ORDEN_COMPRA', 'Orden de compra/servicio', 7, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_DOCUMENTO', 'OTROS', 'Otros', 8, 1);

-- 7.3 Motivos de Cierre
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('MOTIVO_CIERRE', 'PRECIO', 'Precio', 1, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('MOTIVO_CIERRE', 'COMPETENCIA', 'Competencia', 2, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('MOTIVO_CIERRE', 'SIN_PRESUPUESTO', 'Sin presupuesto', 3, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('MOTIVO_CIERRE', 'ALCANCE_NO_ALINEADO', 'Alcance no alineado', 4, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('MOTIVO_CIERRE', 'CLIENTE_DESISTIO', 'Cliente desistió', 5, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('MOTIVO_CIERRE', 'NO_RESPUESTA', 'No respuesta', 6, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('MOTIVO_CIERRE', 'OTRO', 'Otro', 7, 1);

-- 7.4 Monedas
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('MONEDA', 'COP', 'Peso Colombiano', 1, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('MONEDA', 'USD', 'Dólar Estadounidense', 2, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('MONEDA', 'EUR', 'Euro', 3, 1);

-- 7.5 Tipos de Empresa
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_EMPRESA', 'EMPRESA', 'Empresa', 1, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_EMPRESA', 'MULTINACIONAL', 'Multinacional', 2, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('TIPO_EMPRESA', 'ALIADO', 'Aliado', 3, 1);

-- 7.6 Roles de Contacto
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('ROL_CONTACTO', 'DECISOR', 'Decisor', 1, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('ROL_CONTACTO', 'INFLUENCIADOR', 'Influenciador', 2, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('ROL_CONTACTO', 'TECNICO', 'Técnico', 3, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('ROL_CONTACTO', 'USUARIO', 'Usuario', 4, 1);
INSERT INTO GC_CATALOGO (tipo, codigo, nombre, orden, activo) VALUES ('ROL_CONTACTO', 'ADMINISTRATIVO', 'Administrativo', 5, 1);

COMMIT;

-- ============================================================================
-- SECCIÓN 8: USUARIO ADMINISTRADOR INICIAL
-- ============================================================================

-- Usuario admin inicial (password: admin123 - cambiar en producción)
-- Hash generado con BCrypt
INSERT INTO GC_USUARIO (username, email, password_hash, nombres, apellidos, rol, activo)
VALUES ('admin', 'hjcuervo@arqs.com', '$2a$10$N9qo8uLOickgx2ZMRZoMy.MqrqPqwKvfpfD3PLACEHOLDER', 'Administrador', 'Sistema', 'ADMIN', 1);

COMMIT;

-- ============================================================================
-- FIN DEL SCRIPT DDL
-- ============================================================================
```

---

## 3. Resumen de Índices

### 3.1 Índices por Tipo

| Tipo | Cantidad | Propósito |
|------|----------|-----------|
| **Foreign Keys** | 21 | Optimizar JOINs y CASCADE |
| **Búsqueda** | 9 | Filtros frecuentes |
| **Auditoría/Reportes** | 4 | Consultas históricas |
| **Total** | 34 | — |

### 3.2 Índices Recomendados para KPIs

| KPI | Índices que lo soportan |
|-----|------------------------|
| Oportunidades por etapa | `IDX_GC_OPORTUNIDAD_ETAPA`, `IDX_GC_OPORTUNIDAD_ESTADO` |
| Tiempo promedio por etapa | `IDX_GC_HIST_ETAPA_OPORTUNIDAD`, `IDX_GC_HIST_ETAPA_FECHA` |
| Tasa de conversión | `IDX_GC_OPORTUNIDAD_ESTADO`, `IDX_GC_OPORTUNIDAD_PIPELINE` |
| Actividades por oportunidad | `IDX_GC_ACTIVIDAD_OPORTUNIDAD`, `IDX_GC_ACTIVIDAD_FECHA` |

---

## 4. Resumen de Objetos Creados

| Objeto | Cantidad |
|--------|----------|
| Tablas | 17 |
| Primary Keys | 17 |
| Foreign Keys | 29 |
| Unique Constraints | 5 |
| Check Constraints | 25 |
| Índices | 34 |
| Datos iniciales (catálogos) | 30 registros |

---

## 5. Notas de Implementación

### 5.1 Migración con Flyway

Este script debe dividirse en migraciones Flyway:

| Archivo | Contenido |
|---------|-----------|
| `V1__create_base_tables.sql` | Tablas sin FK (Usuario, Catálogo) |
| `V2__create_entity_tables.sql` | Persona, Empresa, Pipeline, Etapa |
| `V3__create_oportunidad.sql` | Oportunidad y tablas relacionadas |
| `V4__create_actividad.sql` | Actividad, Compromiso, Documento |
| `V5__create_auditoria.sql` | Auditoría general |
| `V6__create_indexes.sql` | Todos los índices |
| `V7__insert_catalogos.sql` | Datos iniciales |
| `V8__insert_admin.sql` | Usuario administrador |

### 5.2 Consideraciones Oracle

1. **IDENTITY**: Usar `GENERATED BY DEFAULT AS IDENTITY` para IDs
2. **BOOLEAN**: Oracle no tiene boolean nativo, usar `NUMBER(1)` con CHECK (0,1)
3. **VARCHAR2**: Preferir sobre VARCHAR para Oracle
4. **CLOB**: Para campos JSON de auditoría
5. **Nombres**: Máximo 30 caracteres (límite Oracle tradicional)

---

*Fin del documento B-02 - Modelo Físico Oracle DDL*
