# Archivos de Configuraci√≥n - Listos para Usar

---

## 1. .env.example

```bash
# Base de datos Oracle Standard
DB_URL=jdbc:oracle:thin:@//arqsmallpldbs01-public-phx.infra.arqbs.com:1621/CDBSMALL_ARQSMALLPLDBS01_COMMSRV.paas.oracle.com
DB_USERNAME=ARQGCDEV
DB_PASSWORD=tu_password

# JWT
JWT_SECRET=clave_secreta_minimo_32_caracteres
```

---

## 2. application.yml (backend)

```yaml
spring:
  application:
    name: gestion-backend

  datasource:
    url: ${DB_URL}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    driver-class-name: oracle.jdbc.OracleDriver
    hikari:
      maximum-pool-size: 5

  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: true

  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true

server:
  port: 8080

app:
  jwt:
    secret: ${JWT_SECRET}
    expiration: 28800000

springdoc:
  api-docs:
    path: /api/docs
  swagger-ui:
    path: /api/swagger-ui.html
```

---

## 3. application-prod.yml (backend)

```yaml
spring:
  jpa:
    show-sql: false

logging:
  level:
    root: WARN
    com.arquitecsoft.gestion: INFO
```

---

## 4. docker-compose.yml (desarrollo local)

```yaml
version: '3.8'

services:
  frontend:
    build: ./frontend
    ports:
      - "80:80"
    depends_on:
      - backend

  backend:
    build: ./backend
    ports:
      - "8080:8080"
    environment:
      - DB_URL=${DB_URL}
      - DB_USERNAME=${DB_USERNAME}
      - DB_PASSWORD=${DB_PASSWORD}
      - JWT_SECRET=${JWT_SECRET}
```

---

## 5. docker-compose.prod.yml (producci√≥n)

```yaml
version: '3.8'

services:
  frontend:
    build: ./frontend
    ports:
      - "80:80"
      - "443:443"
    depends_on:
      - backend
    volumes:
      - ./certs:/etc/nginx/certs:ro
    restart: unless-stopped

  backend:
    build: ./backend
    expose:
      - "8080"
    environment:
      - SPRING_PROFILES_ACTIVE=prod
      - DB_URL=${DB_URL}
      - DB_USERNAME=${DB_USERNAME}
      - DB_PASSWORD=${DB_PASSWORD}
      - JWT_SECRET=${JWT_SECRET}
    restart: unless-stopped
```

---

## 6. Frontend - Dockerfile

```dockerfile
FROM node:20-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

---

## 7. Frontend - nginx.conf

```nginx
server {
    listen 80;
    server_name _;
    root /usr/share/nginx/html;
    index index.html;

    gzip on;
    gzip_types text/plain text/css application/json application/javascript;

    location / {
        try_files $uri $uri/ /index.html;
    }

    location /api/ {
        proxy_pass http://backend:8080/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    location /health {
        return 200 '{"status":"UP"}';
        add_header Content-Type application/json;
    }
}
```

---

## 8. Backend - Dockerfile

```dockerfile
FROM eclipse-temurin:21-jdk-alpine AS builder
WORKDIR /app
COPY mvnw pom.xml ./
COPY .mvn .mvn
RUN ./mvnw dependency:go-offline -B
COPY src src
RUN ./mvnw package -DskipTests

FROM eclipse-temurin:21-jre-alpine
WORKDIR /app
COPY --from=builder /app/target/*.jar app.jar
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "app.jar"]
```

---

## 9. deploy.sh

```bash
#!/bin/bash
set -e

SERVER="opc@<TU_IP_PUBLICA>"
APP_DIR="/home/opc/gestion-comercial"

echo "üì§ Copiando archivos al servidor..."
rsync -avz \
  --exclude 'node_modules' \
  --exclude 'target' \
  --exclude '.git' \
  ./ $SERVER:$APP_DIR/

echo "üöÄ Desplegando en servidor..."
ssh $SERVER "cd $APP_DIR && docker-compose -f docker-compose.prod.yml down && docker-compose -f docker-compose.prod.yml up -d --build"

echo "‚úÖ Deploy completo!"
```

---

## 10. Primera migraci√≥n Flyway

**backend/src/main/resources/db/migration/V1__initial_schema.sql**

```sql
CREATE TABLE GC_USUARIOS (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    USERNAME VARCHAR2(50) NOT NULL UNIQUE,
    EMAIL VARCHAR2(100) NOT NULL UNIQUE,
    PASSWORD_HASH VARCHAR2(255) NOT NULL,
    NOMBRE VARCHAR2(100) NOT NULL,
    ACTIVO NUMBER(1) DEFAULT 1,
    FECHA_CREACION TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX IDX_USUARIOS_USERNAME ON GC_USUARIOS(USERNAME);
CREATE INDEX IDX_USUARIOS_EMAIL ON GC_USUARIOS(EMAIL);
```

---

## 11. .gitignore

```gitignore
# Dependencies
node_modules/
target/

# Environment
.env
.env.local
.env.prod

# IDE
.idea/
.vscode/
*.iml

# Build
dist/
*.jar

# OS
.DS_Store
Thumbs.db

# Logs
*.log

# Certs
certs/
```

---

## 12. README.md

```markdown
# Gesti√≥n Comercial - Arquitecsoft

Plataforma interna de gesti√≥n comercial.

## Requisitos

- Docker y Docker Compose
- Node.js 20+ (para desarrollo frontend)
- Java 21+ (para desarrollo backend)

## Base de Datos

Oracle Database Standard:
- Host: arqsmallpldbs01-public-phx.infra.arqbs.com
- Puerto: 1621
- Servicio: CDBSMALL_ARQSMALLPLDBS01_COMMSRV.paas.oracle.com

## Desarrollo Local

1. Copiar `.env.example` a `.env` y configurar password
2. Ejecutar:

### Sin Docker:
- Backend: `cd backend && ./mvnw spring-boot:run`
- Frontend: `cd frontend && npm run dev`

### Con Docker:
```bash
docker-compose up --build
```

3. Abrir http://localhost

## Deploy a Producci√≥n

```bash
./deploy.sh
```
```

---

## 13. Contexto del Proyecto (para nuevas conversaciones con Claude)

```markdown
# Contexto del Proyecto - Plataforma Gesti√≥n Comercial Arquitecsoft

## Informaci√≥n Clave
- Proyecto: Plataforma interna de gesti√≥n comercial
- Empresa: Arquitecsoft
- Usuarios: M√°ximo 5
- Criticidad: Herramienta de apoyo

## Stack Tecnol√≥gico
- Frontend: Vue 3 + Vite + PrimeVue
- Backend: Java 21 + Spring Boot 3.3
- BD: Oracle Database Standard (NO es ATP, conexi√≥n JDBC directa)
- Host BD: arqsmallpldbs01-public-phx.infra.arqbs.com:1621
- Servicio BD: CDBSMALL_ARQSMALLPLDBS01_COMMSRV.paas.oracle.com
- Esquema: ARQGCDEV
- Migraciones: Flyway
- Contenedores: Docker Compose
- Servidor: 1 VM en OCI
- Deploy: Script bash manual

## Arquitectura
1 VM con Docker Compose (Nginx+Vue, Spring Boot) conectando a Oracle Standard externo.

## Lo que NO se usa
- Kubernetes, Load Balancer, WAF
- CI/CD complejo
- Oracle Wallet (no es ATP)
- APM, Vault, m√∫ltiples ambientes

## Prioridad
Simplicidad. No sobre-ingenierizar.
```
